{
  "version": 3,
  "sources": [
    "node_modules/browser-pack/_prelude.js",
    "src/blocks/all.js",
    "src/blocks/buttons.js",
    "src/blocks/checks.js",
    "src/blocks/list.js",
    "src/blocks/multi.js",
    "src/blocks/radios.js",
    "src/blocks/select.js",
    "src/rasti.js",
    "src/utils.js"
  ],
  "names": [],
  "mappings": "AAAA;ACAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACPA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACzCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACvCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACdA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACzMA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC7BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AC7GA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;AC/yCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA",
  "file": "generated.js",
  "sourceRoot": "",
  "sourcesContent": [
    "(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})",
    "module.exports = {\r\n    list    : require('./list'),\r\n\tbuttons : require('./buttons'),\r\n\tchecks  : require('./checks'),\r\n\tradios  : require('./radios'),\r\n\tmulti   : require('./multi'),\r\n\tselect  : require('./select'),\r\n}",
    "const utils = require('../utils')\r\n\r\nmodule.exports = {\r\n\r\ntemplate : function(data, $el) {\r\n    return data\r\n        .map( d => utils.checkData(d) )\r\n        .map( d => `<div value=\"${d.value}\">${d.label}</div>` )\r\n        .join('')\r\n},\r\n\r\ninit : function($el) {\r\n    $el.on('click', 'div', function(e) {\r\n        $el.val($(e.target).attr('value'))\r\n            .trigger('change')\r\n    })\r\n    $el.on('change', function(e) {\r\n        $el.children().removeClass('active')\r\n        $el.find('[value=\"'+ $el.val() +'\"]').addClass('active')\r\n    })\r\n},\r\n\r\nstyle : `\r\n    [block=buttons] > div {\r\n        display: inline-block;\r\n        margin: 5px !important;\r\n        padding: 5px 10px;\r\n        border-radius: 6px;\r\n        border: 2px outset rgba(255, 255, 255, 0.5);\r\n        background-clip: padding-box;\r\n        cursor: pointer;\r\n    }\r\n    [block=buttons] > div.active {\r\n        filter: contrast(1.5);\r\n        border-style: inset;\r\n        padding: 4px 11px 6px 9px;\r\n        transform: translateY(-1px);\r\n    }\r\n`\r\n\r\n}\r\n",
    "const utils = require('../utils')\n\nmodule.exports = {\n\ntemplate : function(data, $el) {\n    var uid = utils.random()\n    return data\n        .map( d => utils.checkData(d) )\n        .map( d => `<input type=\"checkbox\" name=\"${uid}[]\" value=\"${d.value}\"><label>${d.label}</label>` )\n        .join('')\n},\n\ninit : function($el) {\n    var values = $el[0].value = []\n    $el.on('click', 'label', function(e) {\n        // forward clicks to hidden input\n        $(e.currentTarget).prev().click()\n    })\n    $el.on('change', 'input', function(e) {\n        // update component value\n        var $input = $(e.currentTarget),\n            val = $input.attr('value')\n        $input.prop('checked')\n            ? values.push(val)\n            : values.remove(val)\n    })\n    $el.on('change', function(e) {\n        // update component ui\n        var $input, checked\n        $el.find('input').each(function(i, input){\n            $input = $(input)\n            checked = values.includes( $input.attr('value') )\n            $input.prop('checked', checked)\n        })\n    })\n},\n\nstyle : ``\n\n}",
    "const utils = require('../utils')\r\n\r\nmodule.exports = {\r\n\r\ntemplate : function(data, $el) {\r\n    return data\r\n        .map( d => `<li>${d}</li>` )\r\n        .join('')\r\n},\r\n\r\ninit : function($el) {},\r\n\r\nstyle : ''\r\n\r\n}",
    "const utils = require('../utils')\n\nmodule.exports = {\n\ntemplate : function(data, $el) {\n    $el[0].total = data.length // WARNING : SIDE EFFECTS\n\n    var ret = $el[0].hasAttribute('filter')\n        ? `<input field type=\"text\" placeholder=\"${ $el.attr('filter') }\"/>`\n        : ''\n\n    return ret + data\n        .map( d => utils.checkData(d) )\n        .map( d => `<option value=\"${d.value}\" alias=\"${d.alias}\">${d.label}</option>` )\n        .join('')\n},\n\ninit : function($el) {\n    var el = $el[0]\n    var field = $el.attr('field')\n\n    if (!field) return error('Missing field name in [field] attribute of element:', el)\n    \n    el.value = []\n    el.max = parseInt($el.attr('max'))\n\n    if (el.initialized) {\n        // empty selected options (and remove full class in case it was full)\n        $el.find('[selected]').empty()\n        $el.removeClass('full')\n        // then exit (skip structure and bindings)\n        return\n    }\n\n    // structure\n\n    $el.html('<div selected/><div add/>')\n    $el.closest('[page]').children('.page-options')\n        .append('<div field block=multi options='+ field +'>')\n    var $selected = $el.find('[selected]')\n    var $options = $el.closest('[page]').find('[options='+ field +']')\n\n    // bindings\n\n    $el.on('click', function(e) {\n        $options.siblings('[options]').hide() // hide other options\n        if ( utils.onMobile() ) $options.parent().addClass('backdrop')\n        $options.css('left', this.getBoundingClientRect().right).show()\n        $options.find('input').focus()\n    })\n\n    $el.closest('[page]').on('click', '*:not(option)', function(e) {\n        if ( $(e.target).attr('field') === field\n          || $(e.target).parent().attr('field') === field ) return\n        if ( utils.onMobile() ) $options.parent().removeClass('backdrop')\n        $options.hide()\n    })\n\n    var toggleOption = function(e) {\n        e.stopPropagation()\n        $options.find('input').focus()\n        var $opt = $(e.target),\n            val = $opt.attr('value'),\n            values = $el[0].value\n\n        if ($opt.parent().attr('options')) {\n            // select option\n            $el.find('[selected]').append($opt)\n            values.push(val)\n        }\n        else {\n            // unselect option\n            $options.append($opt)\n            values.remove(val)\n        }\n        checkFull()\n        $el.trigger('change', {ui: true}) \n    }\n\n    $el.on('click', 'option', toggleOption)\n\n    $options.on('click', 'option', toggleOption)\n\n    $options.on('click', function(e) { $options.find('input').focus() })\n\n    $options.on('input', 'input', function(e) {\n        this.value\n            ? $options.find('option').hide().filter('[alias*='+ this.value +']').show()\n            : $options.find('option').show()\n    })\n\n    $el.on('change', function(e, params){\n        if (params && params.ui) return // triggered from ui, do nothing\n        $selected.children().each(function(i, el) {\n            $options.append(el)\n        })\n        for (var val of el.value) {\n            $selected.append($options.find('[value='+ val +']'))\n            if ( checkFull() ) break\n        }\n    })\n\n    function checkFull() {\n        var qty = $selected.children().length,\n            dif = el.value.length - qty,\n            isFull = qty >= (el.max || el.total)\n\n        if (isFull) {\n            if (dif > 0) {\n                el.value = el.value.slice(0, qty)\n                rasti.warn('Dropped %s overflowed values in el:', dif, el)\n            }\n            $el.addClass('full')\n            if ( utils.onMobile() ) $options.parent().removeClass('backdrop')\n            $options.hide()\n        }\n        else {\n            $el.removeClass('full')\n        }\n\n        return isFull\n    }\n\n    el.initialized = true\n},\n\nstyle : `\n    [block=multi] {\n        display: flex;\n        min-height: 35px;\n        padding-right: 0;\n        text-shadow: 0 0 0 #000;\n        cursor: pointer;\n    }\n    [block=multi] [add] {\n        display: flex;\n        align-items: center;\n        width: 20px;\n        border-left: 1px solid rgba(0,0,0,0.2);\n    }\n    [block=multi] [add]:before {\n        content: '〉';\n        padding-left: 6px;\n    }\n    [block=multi].open [add] {\n        box-shadow: inset 0 0 2px #000;\n    }\n    [block=multi].full {\n        padding-right: 5px;\n    }\n    [block=multi].full [add] {\n        display: none;\n    }\n    [block=multi] option {\n        padding: 2px 0;\n    }\n    [block=multi] option:before {\n        content: '✕';\n        display: inline-block;\n        box-sizing: border-box;\n        height: 20px;\n        width: 20px;\n        margin-right: 5px;\n        border-radius: 50%;\n        text-align: center;\n        line-height: 1.5;\n    }\n    [block=multi] [selected] {\n        flex-basis: 100%;\n        max-height: 100px;\n        overflow-y: auto;\n    }\n    [block=multi] [selected] > option:hover:before {\n        color: #d90000;\n        background-color: rgba(255, 0, 0, 0.5);\n    }\n    [block=multi][options] {\n        display: none;\n        position: absolute;\n        top: 0;\n        width: 250px;\n        height: 100%;\n        padding: 5px 10px;\n        border: 1px solid;\n        z-index: 10;\n        overflow-y: auto;\n    }\n    [block=multi][options] > option:before {\n        transform: rotate(45deg);\n    }\n    [block=multi][options] > option:hover:before {\n        color: #008000;\n        background-color: rgba(0, 128, 0, 0.5);\n    }\n    [block=multi][options] input {\n        border: 1px solid #000;\n        margin: 10px 0;\n    }\n\n`\n\n}",
    "const utils = require('../utils')\n\nmodule.exports = {\n\ntemplate : function(data, $el) {\n    var uid = utils.random()\n    return data\n        .map( d => utils.checkData(d) )\n        .map( d => `<input type=\"radio\" name=\"${uid}\" value=\"${d.value}\"/><label>${d.label}</label>` )\n        .join('')\n},\n\ninit : function($el) {\n    $el.on('click', 'label', function(e) {\n        // forward clicks to hidden input\n        $(e.currentTarget).prev().click()\n    })\n    $el.on('change', 'input', function(e) {\n        // update component value\n        $el.val( $(e.currentTarget).attr('value') )\n    })\n    $el.on('change', function(e) {\n        // update component ui\n        $el.find('[value=\"'+ $el.val() +'\"]').prop('checked', true)\n    })\n},\n\nstyle : ``\n\n}",
    "const utils = require('../utils')\r\n\r\nmodule.exports = {\r\n\r\ntemplate : function(data, $el) {\r\n    var ret = ''\r\n    for (var d of data) {\r\n        d = utils.checkData(d)\r\n        ret += `<option value=\"${d.value}\">${d.label}</option>`\r\n    }\r\n    return ret\r\n},\r\n\r\ninit : function($el) {\r\n    var imgpath = $el.attr('img')\r\n    if (!imgpath) return\r\n\r\n    var $selected = $el.find('[selected]'),\r\n        $wrapper = $('<div select>'),\r\n        $options = $('<div options>')\r\n\r\n    // clone original select\r\n    $.each($el[0].attributes, function() {\r\n        $wrapper.attr(this.name, this.value);\r\n    });\r\n\r\n    // wrap with clone\r\n    $el.wrap($wrapper)\r\n    // regain wrapper ref (it is lost when wrapping)\r\n    $wrapper = $el.parent()\r\n    // add caret\r\n    $wrapper.append('<div caret>&#9660</div>')\r\n\r\n    if (!$el.attr('data')) {\r\n        // clone original options\r\n        $el.find('option').each(function(opt, i) {\r\n            $options.append(`<div value=\"${opt.value}\">${opt.innerHTML}</div>`)\r\n        })\r\n    }\r\n    // add options\r\n    $wrapper.append($options)\r\n    // replace ref with divs\r\n    $options = $options.children()\r\n\r\n    // recreate selected option, if none select first one\r\n    var i = $selected.length ? $selected.index() : 0\r\n    $options[i].classList.add('selected')\r\n    // recreate select value\r\n    $wrapper.val($el.val() || $options[i].getAttribute('value'))\r\n\r\n    // add images\r\n    setImg($wrapper, imgpath)\r\n    $options.each(function(i, el) {\r\n        setImg($(el), imgpath)\r\n    })\r\n\r\n    // bind clicks\r\n    $options.click(function(e) {\r\n        var $opt = $(this)\r\n        $opt.siblings().removeClass('selected')\r\n        $opt.addClass('selected')\r\n        var $wrapper = $opt.closest('[select]')\r\n        $wrapper.val($opt.attr('value'))\r\n        var imgpath = $wrapper.attr('img')\r\n        if (imgpath) setImg($wrapper, imgpath)\r\n    })\r\n\r\n    // remove original select\r\n    $el.remove()\r\n\r\n},\r\n\r\nstyle : `\r\n    [select] select {\r\n        display: none;\r\n    }\r\n    [select] {\r\n        cursor: pointer;\r\n        border-radius: 4px;\r\n    }\r\n    [select]:hover [options] {\r\n        display: block;\r\n    }\r\n    [select] [options] {\r\n        display: none;\r\n        position: absolute;\r\n        margin-top: 42px;\r\n        margin-left: -4px;\r\n        border: 4px solid #b9b9b9;\r\n        border-radius: 4px;\r\n    }\r\n    [select] [options] div:hover {\r\n        border: 4px solid #fff;\r\n    }\r\n    [select] [options] div.selected {\r\n        border: 2px solid #0f97bd;\r\n    }\r\n    [select] [caret] {\r\n        float: right;\r\n        margin-top: 15px;\r\n        margin-right: 5px;\r\n        font-size: small;\r\n    }\r\n    [select][img] {\r\n        padding: 0;\r\n    }\r\n`\r\n\r\n}\r\n",
    "/* zepto */\n\nvar utils = require('./utils'),\n    is = utils.is,\n    type = utils.type,\n    sameType = utils.sameType\n\nvar options = {\n    persist : false,\n    history : false,\n    root    : '',\n    theme   : 'base',\n    lang    : '',\n    stats   : '%n results in %t seconds',\n    noData  : 'No data available',\n}\n\nvar breakpoints = {\n    phone : 500,\n    tablet : 800,\n}\nvar media = {}\nfor (var device in breakpoints) {\n    media[device] = window.matchMedia(`(max-width: ${ breakpoints[device] }px)`).matches\n}\n\nvar log = function (...params) {\n        if (rasti.options.log.search(/debug/i) != -1) console.log.call(this, ...params)\n    },\n    warn = function (...params) {\n        if (rasti.options.log.search(/(warn)|(debug)/i) != -1) console.warn.call(this, ...params)\n    },\n    error = function (...params) {\n        console.error.call(this, ...params)\n    }\n\n\nvar rasti = function(name, container) {\n\n    var errPrefix = 'Cannot create rasti app: '\n\n    if ( !is.string(name) ) return error(errPrefix + 'app must have a name!')\n\n    this.name = name.replace(' ', '')\n\n    if ( !container ) {\n        container = $('body')\n    }\n    else if ( !(container.selector) ) {\n        if ( is.string(container) || (container.tagName && 'BODY DIV'.search(container.tagName) != -1) ) container = $(container)\n        else return error(errPrefix + 'app container is invalid. Please provide a selector string, a jQuery object ref or a DOM element ref')\n    }\n    container.attr('rasti', this.name)\n    \n    var self = this\n\n    var invalidData = 0\n\n\n    // private properties  \n\n    this.active = {\n        page  : null,\n        theme : '',\n        lang  : '',\n    }\n\n    this.pagers = new Map()\n\n\n    // public properties\n\n    this.options = Object.assign({}, options)\n\n    this.defaults = {\n        stats : self.options.stats,\n        noData : self.options.noData,\n    }\n\n    this.state = {}\n    Object.defineProperties(self.state, {\n        page  : { get : function() { return self.active.page.attr('page') }, enumerable : true },\n        theme : { get : function() { return self.active.theme }, enumerable : true },\n        lang  : { get : function() { return self.active.lang }, enumerable : true },\n        save : { value : function() {\n            localStorage.setItem('rasti.' + self.name, JSON.stringify(self.state))\n            log('State saved')\n        } },\n        get : { value : function() {\n            var state\n            try {\n                state = JSON.parse( localStorage.getItem('rasti.' + self.name) )\n                if ( !state ) log('No saved state found for app [%s]', self.name)\n                else if ( !is.object(state) ) invalid()\n                else return state\n            }\n            catch(err) {\n                invalid()\n            }\n\n            function invalid() {\n                error('Saved state for app [%s] is invalid', self.name)\n            }\n        } },\n        restore : { value : function() {\n            var state = self.state.get()\n            if (state) {\n                log('Restoring state...')\n                for (let prop in state) {\n                    self.state[prop] = state[prop]\n                }\n                if (state.theme) setTheme(state.theme)\n                if (state.lang) setLang(state.lang)\n                navTo(state.page)\n                log('State restored')\n            }\n            return state\n        } },\n        clear : { value : function() {\n            localStorage.removeItem('rasti.' + self.name)\n        } },\n    })\n\n    this.pages = {}\n\n    this.data = {}\n\n    this.ajax = {}\n\n    this.utils = {\n        is : is,\n        type : type,\n        sameType : sameType,\n    }\n\n    this.templates = {}\n\n    this.langs = {}\n\n\n    this.themes = {\n\n        base : {\n            font : 'normal 14px sans-serif',\n            palette : {\n                white   : '#fff',\n                lighter : '#ddd',\n                light   : '#bbb',\n                mid     : '#888',\n                dark    : '#444',\n                darker  : '#222',\n                black   : '#000',\n                detail  : 'darkcyan',\n                lighten : 'rgba(255,255,255,0.2)',\n                darken  : 'rgba(0,0,0,0.2)',\n            },\n        },\n\n    }\n\n\n    this.themeMaps = {\n\n        dark : {\n            page    : 'darker lighten', // bg, header bg\n            panel   : 'dark lighten',   // bg, header bg\n            section : 'mid lighten',    // bg, header bg\n            field   : 'light darker',   // bg, text\n            btn     : 'detail darker',  // bg, text\n            header  : 'darker',         // text\n            label   : 'darker',         // text\n            text    : 'darker',         // text\n        },\n\n        light : {\n            page    : 'lighter darken',\n            panel   : 'mid lighten',\n            section : 'light darken',\n            field   : 'lighter dark',\n            btn     : 'detail light',\n            header  : 'dark',\n            label   : 'mid',\n            text    : 'dark',\n        },\n        \n    }\n\n    // methods\n\n    function extend(props) {\n        if (!props || !is.object(props)) return error('Cannot extend app: no properties found')\n        for (var key in self) {\n            if ($.type(self[key]) === 'object' && $.type(props[key]) === 'object')\n                Object.assign(self[key], props[key])\n        }\n    }\n\n\n    function init(options) {\n        var initStart = window.performance.now()\n        log('Initializing app [%s]...', self.name)\n\n        container.addClass('big loading backdrop')\n\n        // cache options\n        if (options) {\n            if ( !is.object(options) ) warn('Init options must be an object!')\n            else Object.keys(self.options).forEach(function(key){\n                if (options[key]) {\n                    if ( !sameType(self.options[key], options[key])  ) warn('Init option [%s] is invalid', key)\n                    else self.options[key] = options[key]\n                }\n            })\n        }\n\n\n        // apply defaults\n        Object.keys(self.defaults).forEach(function(key){\n            if (!self.options[key]) self.options[key] = self.defaults[key]\n        })\n        \n\n        // define lang (if not already defined)\n        if (!self.options.lang) {\n            keys = Object.keys(self.langs)\n            if (keys.length) self.options.lang = keys[0]\n        }\n\n\n        // append theme style container\n        container.append('<style theme>')\n\n\n        // append page-options containers\n        container.find('[page]').each(function(i, el) {\n            $(el).append('<div class=\"page-options\">')\n        })\n\n\n        // init rasti blocks\n        container.find('[block]').each(function(i, el) {\n            initBlock($(el))\n        })\n\n\n        // create options for selects and lists with data source\n        container.find('select[data]')\n            .add('ol[data]', container)\n            .add('ul[data]', container)\n            .each(function(i, el) {\n                updateBlock($(el))\n            })\n\n\n        // create tabs\n        container.find('.tabs').each(function(i, el) {\n            createTabs($(el))\n        })\n        if (media.tablet || media.phone) container.find('.tabs-tablet').each(function(i, el) {\n            createTabs($(el))\n        })\n        if (media.phone) container.find('.tabs-phone').each(function(i, el) {\n            createTabs($(el))\n        })\n\n\n        // add close btn to modals\n        container.find('[modal]').each(function(i, el) {\n            $('<div class=\"icon close top right\" />')\n            .on('click', function(e){\n                $(this).parent().hide()\n                self.active.page.find('.backdrop').removeClass('backdrop')\n            })\n            .appendTo(el)\n        })\n\n\n        // init field validations\n        container.find('[validate]').on('click', function (e) {\n            var $container = $(this).parent().removeClass('invalid')\n            var invalid\n            $container.find('[field][required]').each(function(i, el){\n                invalid = el.validity && !el.validity.valid\n                el.classList.toggle('error', invalid)\n                if (invalid) $container.addClass('invalid')\n            })\n            if ($container.hasClass('invalid')) {\n                // prevent any default actions\n                e.preventDefault()\n                // and any custom actions (such as nav)\n                e.stopImmediatePropagation()\n            }\n        })\n\n\n        // init nav\n        container.find('[nav]').click(function(e) {\n            var $el = $(this),\n                page = $el.attr('nav'),\n                params = {}\n\n            if (!page) return error('Missing page name in [nav] attribute of element:', el)\n\n            if (this.hasAttribute('params')) {\n                var $page = self.active.page,\n                    paramkeys = $el.attr('params'),\n                    $paramEl\n                if (paramkeys) {\n                    // get specified params\n                    paramkeys = paramkeys.split(' ')\n                    paramkeys.forEach(function(key) {\n                        $paramEl = $page.find('[navparam='+ key +']')\n                        if ($paramEl.length) params[key] = $paramEl.val()\n                        else warn('Could not find navparam element [%s]', key)\n                    })\n                }\n                else {\n                    // get all params\n                    $page.find('[navparam]').each(function(i, el){\n                        $el = $(el)\n                        key = resolveAttr($el, 'navparam')\n                        if (key) params[key] = $el.val()\n                    })\n                }\n            }\n            navTo(page, params)\n        })\n\n\n        // init submit\n        container.find('[submit]').click(function(e) {\n            var $el = $(this),\n                method = $el.attr('submit'),\n                callback = $el.attr('then'),\n                template = $el.attr('render'),\n                isValidCB = callback && is.function(self.utils[callback]),\n                start = window.performance.now(), end\n\n            if (!method) return error('Missing ajax method in [submit] attribute of el:', this)\n\n            if (callback && !isValidCB) error('Undefined utility method [%s] declared in [then] attribute of el:', callback, this)\n            \n            $el.addClass('loading').attr('disabled', true)\n\n            submitAjax(method, function(resdata){ \n                var time = Math.floor(window.performance.now() - start) / 1000\n                log('Ajax method [%s] took %s seconds', method, time)\n\n                if (isValidCB) self.utils[callback](resdata)\n                if (template) render(template, resdata, time)\n\n                $el.removeClass('loading').removeAttr('disabled')\n            })\n        })\n\n\n        // init render\n        container.find('[render]').not('[submit]').click(function(e) {\n            var $el = $(this),\n                template = $el.attr('render')\n            if (!template) return error('Missing template name in [render] attribute of element:', el)\n            render(template)\n        })\n\n\n        // init actions\n        for (var action of 'click change hover load'.split(' ')) {\n            container.find('[on-'+ action +']').each(function(i, el){\n                var $el = $(el),\n                    methodName = $el.attr('on-' + action)\n                if ( !methodName ) return error('Missing utility method in [%s] attribute of element:', action, el)\n                var method = self.utils[methodName]\n                if ( !method ) return error('Undefined utility method \"%s\" declared in [on-%s] attribute of element:', methodName, action, el)\n                $el.on(action, method)\n                   .removeAttr('on-' + action)\n            })\n        }\n        for (var action of 'show hide toggle'.split(' ')) {\n            container.find('['+ action +']').each(function(i, el){\n                var $el = $(el),\n                    $page = $el.closest('[page]'),\n                    targetSelector = $el.attr(action)\n                if ( !targetSelector ) return error('Missing target selector in [%s] attribute of element:', action, el)\n                var $target = $page.find('['+targetSelector+']')\n                if ( !$target.length ) $target = container.find('['+targetSelector+']')\n                if ( !$target.length ) return error('Could not find target [%s] declared in [%s] attribute of element:', targetSelector, action, el)\n                $el.on('click', function(e){\n                        if ($target[0].hasAttribute('modal')) $page.find('.page-options').addClass('backdrop')\n                        $target[action]()\n                    })\n                    .removeAttr(action)\n            })\n        }\n\n\n        // init move\n        container.find('.move').each(function(i, el){\n            $(el).move()\n        })\n\n\n        // init collapse\n        container.find('.collapse').on('click', function(e){\n            this.classList.toggle('folded')\n        })\n\n\n        // init pages\n        var page, $page\n        for (var name in self.pages) {\n            page = self.pages[name]\n            if ( !is.object(page) ) return error('pages.%s must be an object!', name)\n            $page = container.find('[page='+ name +']')\n            if ( !$page.length ) return error('No container found for page \"%s\". Please bind one via [page] attribute', name)\n            if (page.init) {\n                if ( !is.function(page.init) ) return error('pages.%s.init must be a function!', name)\n                else {\n                    log('Initializing page [%s]', name)\n                    self.active.page = $page\n                    page.init()\n                }\n            }\n        }\n\n\n        // resolve empty headers and labels\n        'header label'.split(' ').forEach(function(attr){\n            var $el\n            container.find('['+attr+']').each(function(i, el) {\n                $el = $(el)\n                if (!$el.attr(attr)) $el.attr( attr, resolveAttr($el, attr) )\n            })\n        })\n\n\n        // fix labels\n        'input select textarea'.split(' ').forEach(function(tag){\n            container.find(tag + '[label]').each(function(i, el) {\n                fixLabel($(el))\n            })\n        })\n\n\n        // bind nav handler to popstate event\n        window.onpopstate = function(e) {\n            var page = e.state || location.hash.substring(1)\n            page\n                ? e.state ? navTo(page, null, true) : navTo(page)\n                : navTo(self.options.root)\n        }\n\n\n        // init history (if applicable)\n        if (self.options.history) initHistory()\n\n\n        // restore and persist state (if applicable)\n        var restored\n        if (self.options.persist) {\n            restored = self.state.restore()\n            $(window).on('beforeunload', function(e){ self.state.save() })\n        }\n\n        if ( !self.options.persist || !restored ) {\n\n            // set lang (if applicable and not already set)\n            if ( self.options.lang && !self.active.lang ) setLang(self.options.lang)\n            // if no lang, generate texts\n            if ( !self.options.lang ) {\n                container.find('[text]').each(function(i, el) {\n                    $(el).text( $(el).attr('text') )\n                })\n            }\n\n            // set theme (if not already set)\n            if ( !self.active.theme ) setTheme(self.options.theme)\n\n            // nav to page in hash or to root or to first page container\n            var page = location.hash.substring(1) || self.options.root\n            navTo(page && self.pages[page] ? page : container.find('[page]').first().attr('page'))\n        }\n\n\n        // init state elements\n        container.find('[state]').each(function(i, el){\n            var $el = $(el)\n            var prop = resolveAttr($el, 'state')\n\n            if (!prop) return\n\n            if (el.value !== undefined) {\n                // it's an element\n                bindElement($el, prop)\n            }\n            else {\n                // it's a container\n                $el.find('[field]').each(function(i, el){\n                    $el = $(el)\n                    bindElement($el, prop, $el.attr('field'))\n                })\n            }\n\n            function bindElement($el, prop, subprop){\n                var root = self.state\n                if (subprop) {\n                    root[prop] = root[prop] || {}\n                    root = root[prop]\n                    prop = subprop\n                }\n                if ( root[prop] ) {\n                    $el.val( root[prop] )\n                    if ( $el.attr('block') ) $el.trigger('change')\n                }\n                else root[prop] = ''\n                $el.on('change', function(e){\n                    root[prop] = $el.val()\n                })\n            }\n        })\n\n\n        container\n            .on('click', '.backdrop', function(e){\n                $(e.target).removeClass('backdrop')\n                self.active.page.find('[modal]').hide()\n            })\n            .removeClass('big loading backdrop')\n\n        var initTime = Math.floor(window.performance.now() - initStart) / 1000\n        log('App [%s] initialized in %ss', self.name, initTime)\n\n    }\n\n\n    function get(selector) {\n        var $els = self.active.page && self.active.page.find('['+ selector +']')\n        if (!$els || !$els.length) $els = container.find('['+ selector +']')\n        if (!$els.length) warn('No elements found for selector [%s]', selector)\n        return $els\n    }\n\n    function set(selector, value) {        \n        var $els = get(selector)\n        $els.each(function(i, el){\n            el.value = value\n            $(el).change()\n        })\n        return $els\n    }\n\n    function add(selector, ...values) {\n        var $els = get(selector)\n        $els.each(function(i, el){\n            values.forEach(function(val){\n                if (is.array(val)) el.value = el.value.concat(val)\n                else el.value.push(val)\n            })\n            $(el).change()\n        })\n        return $els\n    }\n\n\n    function navTo(pagename, params, skipPushState) {\n\n        if (!pagename) return error('Cannot navigate, page undefined')\n\n        var $prevPage = self.active.page,\n            prevPagename = $prevPage && $prevPage.attr('page'),\n            prevPage = prevPagename && self.pages[prevPagename]\n        \n        if (pagename == prevPagename) return\n\n        var page = self.pages[pagename],\n            $page = container.find('[page='+ pagename +']')\n\n        if (!$page.length) return error('Cannot navigate to page [%s]: page container not found', pagename)\n\n        if ($prevPage) $prevPage.removeClass('active')\n\n        if (prevPage && prevPage.out) {\n            !is.function(prevPage.out)\n                ? warn('Page [%s] {out} property must be a function!', prevPagename)\n                : prevPage.out(params)\n        }\n\n        self.active.page = $page\n\n        if ( params && !is.object(params) ) warn('Page [%s] nav params must be an object!', pagename)\n        if (page && page.in) {\n            !is.function(page.in)\n                ? warn('Page [%s] {in} property must be a function!', pagename)\n                : page.in(params)\n        }\n\n        $page.addClass('active')\n\n        container\n            .find('nav [nav]').removeClass('active')\n            .filter('[nav='+ pagename +']').addClass('active')\n\n        container.trigger('rasti-nav')\n\n        if (skipPushState) return\n        if (page && page.url) {\n            !is.string(page.url)\n                ? warn('Page [%s] {url} property must be a string!', pagename)\n                : window.history.pushState(pagename, null, '#'+page.url)\n        }\n        else {\n            window.history.pushState(pagename, null)\n        }\n    }\n\n\n    function render(name, data, time) {\n        var template = self.templates[name], html,\n            errPrefix = 'Cannot render template [%s]: '\n        if (!template) return error(errPrefix + 'template is not defined', name)\n\n        if (is.string(template)) {\n            html = template\n            template = function(data, lang) {\n                return data.map(function(obj){ return html }).join()\n            }\n        }\n\n        if (!is.function(template)) return error(errPrefix + 'template must be a string or a function', name)\n\n        var $el = container.find('[template='+ name +']')\n        if (!$el.length) return error(errPrefix + 'no element bound to template. Please bind one via [template] attribute.', name)\n        var el = $el[0]\n\n        if (!data) {\n            var datakey = $el.attr('data')\n            if (!datakey) return error(errPrefix + 'no data found for template. Please provide in ajax response or via [data] attribute in element:', name, el)\n            data = self.data[datakey]\n            if (!data) return error(errPrefix + 'undefined data source \"%s\" in [data] attribute of element:', name, datakey, el)\n        }\n\n        if (!data.length) return $el.html(`<div msg center textc>${ self.options.noData }</div>`)\n\n        var paging = $el.attr('paging')\n        var lang = self.langs && self.langs[self.active.lang]\n        paging\n            ? initPager($el, template, data, lang)\n            : $el.html( template(data, lang) )\n        if (el.hasAttribute('stats')) {\n            var stats = $('<div section class=\"stats\">')\n            stats.html( self.options.stats.replace('%n', data.length).replace('%t', time) )\n            $el.prepend(stats)\n        }\n\n        var fxkey = $el.attr('fx')\n        if (fxkey) {\n            var fx = rasti.fx[fxkey]\n            if (!fx) return warn('Undefined fx \"%s\" in [fx] attribute of element', fxkey, el)\n            paging ? fx($el.find('.results')) : fx($el)\n        }\n\n    }\n\n\n    function setTheme(themeString) {\n        var themeName = themeString.split(' ')[0],\n            theme = self.themes[themeName]\n\n        if (!theme) return error('Cannot set theme [%s]: theme not found', themeName)\n\n        var mapName = themeString.split(' ')[1] || ( is.object(theme.maps) && Object.keys(theme.maps)[0] ) || 'dark',\n            themeMap = ( is.object(theme.maps) && theme.maps[mapName] ) || self.themeMaps[mapName]\n\n        if (!themeMap) return error('Theme map [%s] not found', mapName)\n\n        log('Setting theme [%s:%s]', themeName, mapName)\n        self.active.theme = themeName\n        \n        var values = {\n            font : theme.font || self.themes.base.font,\n        }, colorNames, colors, c1, c2, defaultColorName\n\n        // map palette colors to attributes\n        for (var attr of Object.keys(themeMap)) {\n            if (!self.themeMaps.dark[attr]) return error('Mapping error in theme [%s]. Incorrect theme map property [%s]', themeName, attr)\n\n            colorNames = [c1, c2] = themeMap[attr].split(' ')\n            colors = [theme.palette[ c1 ], theme.palette[ c2 ]]\n\n            for (var i in colors) {\n                defaultColorName = self.themeMaps.dark[attr].split(' ')[i]\n                if (defaultColorName && !colors[i]) {\n                    colors[i] = self.themes.base.palette[ colorNames[i] ]\n                    if (!colors[i]) {\n                        warn('Mapping error in theme [%s] for attribute [%s]. Color [%s] not found. Falling back to default color [%s].', themeName, attr, colorNames[i], defaultColorName)\n                        colors[i] = self.themes.base.palette[ defaultColorName ]\n                    }\n                }\n            }\n            values[attr] = colors\n        }\n\n        // generate theme style and apply it\n        container.find('style[theme]').html( getThemeStyle(values) )\n\n        // apply any styles defined by class\n        for (var key of Object.keys(theme.palette)) {\n            var color = theme.palette[key]\n            container.find('.' + key).css('background-color', color)\n        }\n    }\n\n\n    function setLang(langName) {\n        var lang = self.langs[ langName ],\n            errPrefix = 'Cannot set lang [%s]: '\n\n        if (!lang) return error(errPrefix + 'lang not found', langName)\n        if ( !is.object(lang) ) return error(errPrefix + 'lang must be an object!', langName)\n\n        log('Setting lang [%s]', langName)\n        self.active.lang = langName\n\n        var $elems = $(), $el, keys, string\n        var attributes = 'label header text placeholder'.split(' ')\n\n        attributes.forEach(function(attr){\n            $elems = $elems.add('['+attr+']')\n        })\n\n        $elems.each(function(i, el) {\n            if (el.hasAttribute('fixed')) el = el.children[0]\n            $el = $(el)   \n            keys = el.langkeys\n\n            if (!keys) {\n                keys = {}\n                attributes.forEach(function(attr){\n                    if ($el.attr(attr)) keys[attr] = $el.attr(attr)\n                })\n                el.langkeys = keys\n            }\n\n            for (var attr in keys) {\n                string = getString(langName, keys[attr])\n                attr === 'text'\n                    ? $el.text(string || keys[attr])\n                    : string ? $el.attr(attr, string) : null\n            }\n        })\n\n        Object.keys(self.defaults).forEach(function(key){\n            self.options[key] = lang['rasti_'+key] || self.defaults[key]\n        })\n    }\n\n\n    function updateBlock($el, data) {\n        var types = {\n            SELECT : 'select',\n            OL : 'list',\n            UL : 'list',\n        }\n        var el = $el[0]\n        var type = types[el.nodeName] || $el.attr('block')\n        if (!type) return error('Missing block type in [block] attribute of element:', el)\n        \n        var block = rasti.blocks[type]\n        if (!block) return error('Undefined block type \"%s\" resolved for element:', type, el)\n        \n        if (!data) {\n            var datakey = resolveAttr($el, 'data')\n            if (!datakey) return\n\n            data = self.data[datakey]\n            if (!data) return error('Undefined data source \"%s\" resolved for element:', datakey, el)\n        }\n\n        // TODO: this should be in multi block, not here\n        var $options = type === 'multi'\n            ? $el.closest('[page]').find('[options='+ $el.attr('field') +']')\n            : $el\n\n        is.function(data)\n            ? data(applyTemplate)\n            : applyTemplate(data)\n        \n        function applyTemplate(data) {\n            $options.html( block.template(data, $el) )\n\n            if (invalidData) {\n                var field = $el.attr('field'),\n                    page = $el.closest('[page]').attr('page')\n                warn('Detected %s invalid data entries for field [%s] in page [%s]', invalidData, field, page)\n                invalidData = 0\n            }\n        }\n\n\n    }\n\n\n    function toggleFullScreen(e) {\n        var prefixes = 'moz webkit'.split(' ')\n        prefixes.forEach(function(p){\n            if ( ! (p + 'FullscreenElement' in document) ) return\n            if ( !document[ p + 'FullscreenElement' ]) {\n                document.documentElement[ p + 'RequestFullScreen' ]();\n            }\n            else if (document[ p + 'CancelFullScreen' ]) {\n                document[ p + 'CancelFullScreen' ]();\n            }\n        })\n    }\n\n\n    // internal utils\n\n    function createTabs($el) {\n        var el = $el[0],\n            $tabs = el.hasAttribute('page')\n                ? $el.children('[panel]:not([modal])')\n                : el.hasAttribute('panel')\n                    ? $el.children('[section]:not([modal])')\n                    : undefined\n        if (!$tabs) return error('[tabs] attribute can only be used in pages or panels, was found in element:', el)\n\n        var $labels = $('<div class=\"tab-labels\">'),\n            $bar = $('<div class=\"bar\">'),\n            $tab, label, position\n\n        $tabs.each(function(i, tab){\n            $tab = $(tab)\n            $tab.attr('tab', i)\n            label = resolveAttr($tab, 'tab-label') || 'TAB ' + (i+1)\n\n            $labels.append($(`<div tab-label=${i} text=\"${ label }\">`))\n        })\n\n        $labels.append($bar).prependTo($el)\n        var $flow = $tabs.wrapAll('<div h-flow>').parent()\n\n        $labels.on('click', function(e){\n            var $label = $(e.target),\n                tabnr = $label.attr('tab-label'),\n                $tab = $tabs.filter(`[tab=\"${ tabnr }\"]`)\n\n            $tabs.removeClass('active')\n            $tab.addClass('active')[0].scrollIntoView()\n\n            $labels.children().removeClass('active')\n            $label.addClass('active')\n            \n        })\n\n        $flow.on('scroll', function(e){\n            position = this.scrollLeft / this.scrollWidth\n            $bar.css({ left : position * this.offsetWidth })\n        })\n\n        container.on('rasti-nav', function(e){\n            if (!isInActivePage($el)) return\n            $bar.css({ width : $flow[0].offsetWidth / $tabs.length })\n            if (!$labels.children('.active').length) $labels.children().first().click()\n        })\n\n        $(window).on('resize', function (e) {\n            if (!isInActivePage($el)) return\n            $labels.find('.active').click()\n            $bar.css({ width : $flow[0].offsetWidth / $tabs.length })\n        })\n\n        function isInActivePage($el) {\n            return self.active.page.find($el).length\n                || self.active.page.attr('page') === $el.attr('page')\n        }\n\n    }\n    \n\n    function initBlock($el) {\n        var el = $el[0]\n        var type = el.nodeName == 'SELECT' ? 'select' : $el.attr('block')\n        if (!type) return error('Missing block type in [block] attribute of element:', el)\n        \n        var block = rasti.blocks[type]\n        if (!block) return error('Undefined block type \"%s\" declared in [block] attribute of element:', type, el)\n\n        block.init($el)\n\n        // if applicable, create options from data source\n        if (el.hasAttribute('data')) updateBlock($el)\n    }\n\n\n    function initHistory() {\n        self._history = new History()\n\n        Object.defineProperty(self, 'history', { get: function(){\n            return self._history.content\n        } })\n        Object.defineProperties(self.history, {\n            back : { value : self._history.back },\n            forth : { value : self._history.forth },\n        })\n    }\n\n\n    function initPager($el, template, data, lang) {\n        var name = $el.attr('template'),\n            fx = $el.attr('fx') && rasti.fx[$el.attr('fx')],\n            page_size = parseInt($el.attr('paging')),\n            pager = newPager(name, data, page_size),\n            paging, columns, sizes, col=1, size=0\n\n        if ($el[0].hasAttribute('columns')) columns = `<button btn class=\"icon columns\" />`\n\n        if (pager.total > 1) paging = `<div class=\"paging ib ib_\">\n                <button btn class=\"icon prev\" />\n                <span class=\"page\" />\n                <button btn class=\"icon next\" />\n            </div>`\n\n        sizes = `<button btn class=\"icon rows\" />`\n\n        $el.html(`\n            <div class=\"results scrolly\"></div>\n            <div class=\"controls floatcx bottom ib_\">\n                ${ columns || '' }\n                ${ paging || '' }\n                ${ sizes }\n            </div>\n        `)\n\n        $controls = $el.children('.controls')\n        $results = $el.children('.results')\n\n        $controls.on('click', '.next', function(e){\n            update( pager.next() )\n        })\n\n        $controls.on('click', '.prev', function(e){\n            update( pager.prev() )\n        })\n\n        $controls.on('click', '.rows', function(e){\n            size += 1\n            var newSize = pager.sizes[size % pager.sizes.length]\n            pager.setPageSize(newSize)\n            $(e.target).html(newSize)\n            update( pager.next() )\n            pager.total > 1\n                ? $controls.find('.paging').show()\n                : $controls.find('.paging').hide()\n        })\n\n        $controls.on('click', '.columns', function(e){\n            col = col+1 > 3 ? 1 : col+1\n            $(e.target).html(col)\n            $results.removeClass('columns-1 columns-2 columns-3')\n                .addClass('columns-' + col)\n        })\n\n        $results.html( template(pager.next(), lang) )\n        $controls.find('.page').html(pager.page + '/' + pager.total)\n\n        function update(data){\n            $results.html( template(data, lang) )\n            $controls.find('.page').html(pager.page + '/' + pager.total)\n            if ( is.function(fx) ) fx($results)\n        }\n    }\n\n    function getPager(id) {\n        let pager = self.pagers.get(id)\n        if (!pager) error('No pager found for template [%s]', id)\n        return pager\n    }\n    function newPager(id, results, page_size) {\n        let pager = new Pager(id, results, page_size)\n        self.pagers.set(id, pager)\n        return pager\n    }\n    function deletePager(pager) {\n        if (!pager || !pager.id) return\n        self.pagers.delete(pager.id)\n    }\n\n\n    function submitAjax(method, callback) {\n        var ajax = self.ajax[ method ]\n        if ( !is.function(ajax) ) return error('Ajax method ['+ method +'] is not defined')\n\n        var $form = container.find('[ajax='+ method +']')\n        if (!$form.length) return error('No container element bound to ajax method [%s]. Please bind one via [ajax] attribute', method)\n\n        var reqdata = {}, field\n        $form.find('[field]').each(function(i, el){\n            $el = $(el)\n            field = $el.attr('field')\n            if (field) {\n                reqdata[field] = $el.val() || $el.attr('value')\n            }\n        })\n\n        ajax(reqdata, callback)\n    }\n\n\n    function getThemeStyle(values) {\n        var ns = `[rasti=${ self.name }]`\n        return `\n            ${ns} {\n                font: ${ values.font };\n                color: ${ values.text[0] };\n                background-color: ${ values.page[0] };\n            }\n            ${ns} [page]    { background-color: ${ values.page[0] }; }\n            ${ns} [panel]   { background-color: ${ values.panel[0] }; }\n            ${ns} [section] { background-color: ${ values.section[0] }; }\n\n            ${ns} [page][header]:before,\n            ${ns} [page][footer]:after     { background-color: ${ values.page[1] }; }\n            ${ns} [panel][header]:before   { background-color: ${ values.panel[1] }; }\n            ${ns} [section][header]:before { background-color: ${ values.section[1] }; }\n\n            ${ns} .tab-labels        { background-color: ${ values.panel[0] }; }\n            ${ns} .tab-labels > .bar { background-color: ${ values.btn[0] }; }\n\n            ${ns} [field] {\n                background-color: ${ values.field[0] };\n                color: ${ values.field[1] };\n            }\n\n            ${ns} [btn],\n            ${ns} .btn,\n            ${ns} [block=buttons] > div,\n            ${ns} nav > div.active {\n                background-color: ${ values.btn[0] };\n                color: ${ values.btn[1] }; \n            }\n\n            ${ns} [header]:before { color: ${ values.header[0] }; }\n            ${ns} [label]:not([header]):before  { color: ${ values.label[0] }; }\n        `\n    }\n\n\n    function getString(lang, key) {\n        if ( !is.object(self.langs[lang]) ) {\n            error('Lang [%s] is not defined', lang)\n            return\n        }\n        var string = self.langs[lang][key]\n        if ( !is.string(string) ) warn('Lang [%s] does not contain key [%s]', lang, key)\n        else return string\n    }\n\n\n    function resolveAttr($el, name) {\n        var value = $el.attr(name) || $el.attr('field') || $el.attr('section') || $el.attr('panel') || $el.attr('page')\n        if (!value) warn('Could not resolve value of [%s] attribute in el:', name, $el[0])\n        return value\n    }\n\n\n    function fixLabel($el) {\n        var $div = $(`<div fixed label=\"${ $el.attr('label') }\" >`)\n        $el.wrap($div)\n        $el[0].removeAttribute('label')\n    }\n\n\n    function setImg($el, basepath) {\n        $el.css('background-image', 'url('+ basepath + ($el.val() || $el.attr('value')) +'.png)')\n    }\n\n\n    // internal classes\n\n    class History {\n\n        constructor() {\n            this.i = 0\n            this.content = []\n        }\n        \n        back() {\n            if (this.i > 0) navTo(this.content[--(this.i)])\n        }\n        forth() {\n            if (this.i < this.content.length) navTo(this.content[++(this.i)])\n        }\n        push(page) {\n            this.content.splice(this.i, null, page)\n            this.i++\n        }\n    }\n\n\n    class Pager {\n\n        constructor(id, results, page_size) {\n            this.id = id\n            if ( !is.string(id) ) return error('Pager id must be a string')\n            this.logid = `Pager for template [${ this.id }]:`\n            if ( !is.array(results) ) return error('%s Results must be an array', this.logid)\n            if ( !is.number(page_size) ) return error('%s Page size must be a number', this.logid)\n            this.results = results\n            this.sizes = [5, 10, 20]\n            this.page_size = page_size\n            this.page = 0\n            this.total = Math.ceil(this.results.length / this.page_size)\n\n        }\n\n        next() {\n            if (this.hasNext()) this.page++\n            else warn('%s No next page', this.logid)\n            return this.getPageResults(this.page)\n        }\n\n        prev() {\n            if (this.hasPrev()) this.page--\n            else warn('%s No previous page', this.logid)\n            return this.getPageResults(this.page)\n        }\n\n        hasNext() {\n            return this.results.length > this.page * this.page_size\n        }\n\n        hasPrev() {\n            return this.page > 1\n        }\n\n        setPageSize(size) {\n            size = parseInt(size)\n            if ( !is.number(size) ) return error('%s Must specify a number as the page size', this.logid)\n            this.page_size = size\n            this.page = 0\n            this.total = Math.ceil(this.results.length / this.page_size)\n        }\n\n        getPageResults(page) {\n            if ( !is.number(page) ) {\n                error('%s Must specify a page number to get results from', this.logid)\n                return []\n            }\n            try {\n                var i = (page -1) * this.page_size\n                return this.results.slice(i, i + this.page_size)\n            }\n            catch(err) {\n                error('%s Could not get results of page %s, error:', this.logid, page, err)\n                return []\n            }\n        }\n\n    }\n\n\n\n    // api\n\n    return Object.freeze({\n\n        // objects\n        options : this.options,\n        history : this.history,\n        state : this.state,\n        pages : this.pages,\n        data : this.data,\n        ajax : this.ajax,\n        utils : this.utils,\n        langs : this.langs,\n        themes : this.themes,\n        themeMaps : this.themeMaps,\n        templates : this.templates,\n\n        // methods\n        extend : extend,\n        init : init,\n        get : get,\n        set : set,\n        add : add,\n        navTo : navTo,\n        render : render,\n        setLang : setLang,\n        setTheme : setTheme,\n        updateBlock : updateBlock,\n        toggleFullScreen : toggleFullScreen,\n    })\n\n}\n\n\n// static properties and methods\nrasti.log = log\nrasti.warn = warn\nrasti.error = error\nrasti.blocks = require('./blocks/all')\nrasti.fx = {\n\n    stack : function($el) {\n        $el.children().each(function(i, el){\n            setTimeout(function(){\n                el.style.opacity = 1\n                el.style.marginTop = '15px'\n            }, i * 50);\n        })\n    },\n\n}\nrasti.options = {log : 'debug'}\n\nmodule.exports = Object.freeze(rasti)\n\n\n// prototype extensions\nArray.prototype.remove = function(el) {\n    var i = this.indexOf(el);\n    if (i >= 0) this.splice(i, 1);\n}\nString.prototype.capitalize = function() {\n    return this.length && this[0].toUpperCase() + this.slice(1).toLowerCase()\n}\n\n\n// $ extensions\n$.fn.move = function(options) {\n    var options = $.extend({\n            handle: this,\n            container: this.parent()\n        }, options),\n        object = this,\n        newX, newY,\n        nadir = object.css('z-index'),\n        apex = 100000,\n        hold = 'mousedown touchstart',\n        move = 'mousemove touchmove',\n        release = 'mouseup touchend'\n\n    if (!object[0].hasAttribute('move')) object.attr('move', '')\n\n    options.handle.on(hold, function(e) {\n        if (e.type == 'mousedown' && e.which != 1) return\n        object.css('z-index', apex)\n        var marginX = options.container.width() - object.width(),\n            marginY = options.container.height() - object.height(),\n            oldX = object.position().left,\n            oldY = object.position().top,\n            touch = e.touches,\n            startX = touch ? touch[0].pageX : e.pageX,\n            startY = touch ? touch[0].pageY : e.pageY\n\n        $(window)\n            .on(move, function(e) {\n                var touch = e.touches,\n                    endX = touch ? touch[0].pageX : e.pageX,\n                    endY = touch ? touch[0].pageY : e.pageY\n                newX = Math.max(0, Math.min(oldX + endX - startX, marginX))\n                newY = Math.max(0, Math.min(oldY + endY - startY, marginY))\n\n                window.requestAnimationFrame\n                    ? requestAnimationFrame(setElement)\n                    : setElement()\n            })\n            .one(release, function(e) {\n                e.preventDefault()\n                object.css('z-index', nadir)\n                $(this).off(move).off(release)\n            })\n\n        e.preventDefault()\n    })\n\n    return this\n\n    function setElement() {\n        object.css({top: newY, left: newX});\n    }\n}\n\n\n// bootstrap any apps defined via rasti attribute\nfunction bootstrap() {\n    var appContainers = $(document).find('[rasti]'),\n        appName, app, extendProps\n\n    if (appContainers.length) appContainers.forEach(function(el){\n        appName = el.getAttribute('rasti')\n        if (!appName) error('Missing app name in [rasti] attribute of app container:', el)\n        else if (global[appName]) error('Name [%s] already taken, please choose another name for app in container:', appName, el)\n        else {\n            global[appName] = app = new rasti(appName, el)\n            Object.keys(app.options).forEach(function(key) {\n                if (el.hasAttribute(key)) {\n                    app.options[key] = el.getAttribute(key)\n                    // non-value boolean attributes are true\n                    if (is.boolean(options[key]) && !app.options[key]) app.options[key] = true\n                }\n            })\n            log('Created rasti app [%s]', appName)\n        }\n    })\n}\n\n\nfunction genBlockStyles() {\n    var styles = '<style blocks>'\n    for (var key in rasti.blocks) {\n        styles += rasti.blocks[key].style\n    }\n    styles += '</style>'\n    $('head').prepend(styles)\n}\n\n\nvar rastiCSS\n\n/* rasti CSS */\n\nif (rastiCSS) $('head').prepend('<style>' + rastiCSS + '</style>')\n\ngenBlockStyles()\n\nbootstrap()\n",
    "const is = {}\r\n'object function array string number regex boolean'.split(' ').forEach(function(t){\r\n    is[t] = function(exp){ return type(exp) === t }\r\n})\r\nfunction type(exp) {\r\n        var clazz = Object.prototype.toString.call(exp)\r\n        return clazz.substring(8, clazz.length-1).toLowerCase()\r\n}\r\nfunction sameType(exp1, exp2) {\r\n    return type(exp1) === type(exp2)\r\n}\r\n\r\n\r\nfunction checkData(data) {\r\n    switch (typeof data) {\r\n    case 'string':\r\n        data = {value: data, label: data, alias: data.toLowerCase()}\r\n        break\r\n    case 'object':\r\n        if ( !is.string(data.value) || !is.string(data.label) ) {\r\n            error('Invalid data object (must have string properties \"value\" and \"label\"):', data)\r\n            invalidData++\r\n            data = {value: '', label: 'INVALID DATA', alias: ''}\r\n        }\r\n        else if ( !is.string(data.alias) ) {\r\n            if (data.alias) {\r\n                error('Invalid data property \"alias\" (must be a string):', data)\r\n                invalidData++\r\n            }\r\n            data.alias = data.value.toLowerCase()\r\n        }\r\n        else data.alias = data.alias.toLowerCase() +' '+ data.value.toLowerCase()\r\n        break\r\n    default:\r\n        error('Invalid data (must be a string or an object):', data)\r\n        invalidData++\r\n        data = {value: '', label: 'INVALID DATA', alias: ''}\r\n    }\r\n    return data\r\n}\r\n\r\n\r\nfunction rastiError(msg, ...args){\r\n    this.msg = msg\r\n    this.el = args.pop()\r\n    this.args = args\r\n}\r\n\r\n\r\nfunction random() {\r\n    return (Math.random() * 6 | 0) + 1\r\n}\r\n\r\n\r\nfunction onMobile() {\r\n    return window.innerWidth < 500\r\n}\r\n\r\n\r\nmodule.exports = {\r\n\tis : is,\r\n\ttype : type,\r\n\tsameType : sameType,\r\n\tcheckData : checkData,\r\n\trandom : random,\r\n\tonMobile : onMobile,\r\n    rastiError : rastiError,\r\n}"
  ]
}